<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptanalysis Toolkit</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .header {
            background: #2c3e50;
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .nav-container {
            background: white;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .nav {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            overflow-x: auto;
            scrollbar-width: none;
        }

        .nav::-webkit-scrollbar {
            display: none;
        }

        .nav-item {
            padding: 15px 20px;
            cursor: pointer;
            white-space: nowrap;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: 500;
            color: #666;
        }

        .nav-item:hover {
            background: #f8f9fa;
            color: #2c3e50;
        }

        .nav-item.active {
            color: #2c3e50;
            border-bottom-color: #3498db;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .tool-section {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .tool-section.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tool-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .tool-description {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        .input-group input[type="text"],
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-family: monospace;
            transition: border-color 0.3s;
        }

        .input-group input[type="text"]:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: #3498db;
        }

        .input-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .input-group input[type="number"] {
            width: 150px;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        .output {
            margin-top: 25px;
            padding: 15px;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
            max-height: 500px;
            overflow-y: auto;
        }

        .output.empty {
            display: none;
        }

        .result-item {
            padding: 8px 12px;
            margin: 5px 0;
            background: white;
            border-left: 3px solid #3498db;
            border-radius: 3px;
        }

        .result-highlight {
            background: #fff3cd;
            padding: 2px 4px;
            border-radius: 2px;
        }

        .instructions {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }

        .instructions strong {
            display: block;
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .instructions ul {
            margin-left: 20px;
        }

        .instructions li {
            margin: 5px 0;
            line-height: 1.5;
        }

        .instructions code {
            background: rgba(0,0,0,0.05);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .grid-2 {
                grid-template-columns: 1fr;
            }
        }

        .progress-container {
            display: none;
            margin-top: 15px;
        }

        .progress-bar-bg {
            background: #e0e0e0;
            border-radius: 10px;
            height: 24px;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(90deg, #3498db, #2980b9);
            height: 100%;
            color: white;
            text-align: center;
            line-height: 24px;
            font-size: 12px;
            font-weight: 600;
            transition: width 0.3s;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 14px;
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>Cryptanalysis Toolkit</h1>
            <p>Collection of tools for breaking ciphers and analyzing text</p>
        </div>
    </div>

    <div class="nav-container">
        <div class="nav">
            <div class="nav-item active" onclick="showTool('cipher-tool')">Cipher Tool</div>
            <div class="nav-item" onclick="showTool('vigenere')">Vigenère Cracker</div>
            <div class="nav-item" onclick="showTool('beaufort')">Beaufort Cracker</div>
            <div class="nav-item" onclick="showTool('hexahue')">Hexahue Decoder</div>
            <div class="nav-item" onclick="showTool('ioc')">IoC Analyzer</div>
            <div class="nav-item" onclick="showTool('word-finder')">Word Finder</div>
            <div class="nav-item" onclick="showTool('keyboard')">Keyboard Heatmap</div>
            <div class="nav-item" onclick="showTool('punycode')">Punycode Decoder</div>
        </div>
    </div>

    <div class="container">
        <!-- Cipher Tool -->
        <div id="cipher-tool" class="tool-section active">
            <h2 class="tool-title">Cipher Tool</h2>
            <p class="tool-description">Decrypts common ciphers automatically or with manual selection</p>
            
            <div class="input-group">
                <label>Ciphertext</label>
                <textarea id="cipher-input" placeholder="Enter ciphertext..."></textarea>
            </div>

            <div class="input-group">
                <label>Cipher Type</label>
                <select id="cipher-type">
                    <option value="auto">Auto-detect</option>
                    <option value="caesar">Caesar (ROT)</option>
                    <option value="base64">Base64</option>
                    <option value="morse">Morse Code</option>
                    <option value="mirror">Mirror (Reverse)</option>
                    <option value="l2n">Letter to Number</option>
                </select>
            </div>

            <button class="btn btn-primary" onclick="runCipherTool()">Decrypt</button>
            <button class="btn btn-secondary" onclick="clearOutput('cipher-output')">Clear</button>

            <div id="cipher-output" class="output empty"></div>
        </div>

        <!-- Vigenère Cracker -->
        <div id="vigenere" class="tool-section">
            <h2 class="tool-title">Vigenere Cipher Cracker</h2>
            <p class="tool-description">Break Vigenere cipher using dictionary words or brute force</p>
            
            <div class="instructions">
                <strong>How it works:</strong>
                <ul>
                    <li>Dictionary mode tries all words from a wordlist as keys</li>
                    <li>Brute force tries all letter combinations up to max length</li>
                    <li>Only shows results where plaintext is a valid word</li>
                    <li>Brute force is slow for key length over 4</li>
                </ul>
            </div>

            <div class="input-group">
                <label>Ciphertext</label>
                <input type="text" id="vig-input" placeholder="Enter ciphertext (letters only)">
            </div>

            <div class="input-group">
                <label>Attack Mode</label>
                <select id="vig-mode">
                    <option value="dictionary">Dictionary Attack</option>
                    <option value="brute">Brute Force</option>
                </select>
            </div>

            <div class="input-group" id="vig-brute-options" style="display: none;">
                <label>Max Key Length</label>
                <input type="number" id="vig-max-length" value="4" min="2" max="8">
            </div>

            <button class="btn btn-primary" onclick="runVigenere()">Crack Cipher</button>
            <button class="btn btn-secondary" onclick="clearOutput('vig-output')">Clear</button>

            <div class="progress-container" id="vig-progress">
                <div class="progress-bar-bg">
                    <div class="progress-bar" id="vig-progress-bar" style="width: 0%">0%</div>
                </div>
            </div>

            <div id="vig-output" class="output empty"></div>
        </div>

        <!-- Beaufort Cracker -->
        <div id="beaufort" class="tool-section">
            <h2 class="tool-title">Beaufort Cipher Cracker</h2>
            <p class="tool-description">Break Beaufort cipher using dictionary attack</p>
            
            <div class="instructions">
                <strong>About Beaufort:</strong>
                <ul>
                    <li>Similar to Vigenere but uses different math</li>
                    <li>Formula is (K - P) mod 26 instead of (P + K) mod 26</li>
                    <li>Tries all dictionary words as potential keys</li>
                </ul>
            </div>

            <div class="input-group">
                <label>Ciphertext</label>
                <input type="text" id="beaufort-input" placeholder="Enter ciphertext (letters only)">
            </div>

            <button class="btn btn-primary" onclick="runBeaufort()">Crack Cipher</button>
            <button class="btn btn-secondary" onclick="clearOutput('beaufort-output')">Clear</button>

            <div class="progress-container" id="beaufort-progress">
                <div class="progress-bar-bg">
                    <div class="progress-bar" id="beaufort-progress-bar" style="width: 0%">0%</div>
                </div>
            </div>

            <div id="beaufort-output" class="output empty"></div>
        </div>

        <!-- Hexahue Decoder -->
        <div id="hexahue" class="tool-section">
            <h2 class="tool-title">Hexahue Decoder</h2>
            <p class="tool-description">Decode Hexahue color cipher</p>
            
            <div class="instructions">
                <strong>Letters:</strong> p=pink, r=red, g=green, y=yellow, b=blue, c=cyan<br>
                <strong>Numbers:</strong> g=gray, b=black, w=white<br>
                <strong>Format:</strong> Space-separated 6-character codes like "prgybc rpgybc"
            </div>

            <div class="input-group">
                <label>Hexahue Code</label>
                <input type="text" id="hexahue-input" placeholder="prgybc rpgybc rgpybc">
            </div>

            <button class="btn btn-primary" onclick="runHexahue()">Decode</button>
            <button class="btn btn-secondary" onclick="clearOutput('hexahue-output')">Clear</button>

            <div id="hexahue-output" class="output empty"></div>
        </div>

        <!-- IoC Analyzer -->
        <div id="ioc" class="tool-section">
            <h2 class="tool-title">Index of Coincidence Analyzer</h2>
            <p class="tool-description">Find likely key lengths for Vigenere and other polyalphabetic ciphers</p>
            
            <div class="instructions">
                <strong>How it works:</strong>
                <ul>
                    <li>Paste your ciphertext and run the analysis</li>
                    <li>The graph shows IoC values for different period sizes</li>
                    <li>Peaks indicate likely key lengths</li>
                    <li>English text has an IoC around 0.067</li>
                </ul>
            </div>

            <div class="input-group">
                <label>Ciphertext</label>
                <textarea id="ioc-input" placeholder="Enter ciphertext..."></textarea>
            </div>

            <div class="input-group">
                <label>Max Period to Test</label>
                <input type="number" id="ioc-max-period" value="30" min="5" max="100">
            </div>

            <button class="btn btn-primary" onclick="runIoC()">Analyze</button>
            <button class="btn btn-secondary" onclick="clearOutput('ioc-output')">Clear</button>

            <div id="ioc-canvas-container" style="display: none; margin-top: 20px; background: white; padding: 20px; border-radius: 4px;">
                <canvas id="ioc-canvas" width="1200" height="500"></canvas>
            </div>

            <div id="ioc-output" class="output empty"></div>
        </div>

        <!-- Word Finder -->
        <div id="word-finder" class="tool-section">
            <h2 class="tool-title">Word Finder</h2>
            <p class="tool-description">Find valid words from letter combinations</p>
            
            <div class="instructions">
                <strong>How to use:</strong>
                <ul>
                    <li>Each [bracket] is one position in the word</li>
                    <li>Single letters: <code>[ABC][DEF][GHI]</code></li>
                    <li>Multi-character options: <code>[ABC TH KL][DEF]</code> (space-separated)</li>
                    <li>Example: <code>[ABFH][EMW][DGLP]</code></li>
                </ul>
            </div>

            <div class="input-group">
                <label>Bracket Notation</label>
                <input type="text" id="word-finder-input" placeholder="[ABC][DEF][GHI]">
            </div>

            <button class="btn btn-primary" onclick="runWordFinder()">Find Words</button>
            <button class="btn btn-secondary" onclick="clearOutput('word-finder-output')">Clear</button>

            <div class="progress-container" id="word-finder-progress">
                <div class="progress-bar-bg">
                    <div class="progress-bar" id="word-finder-progress-bar" style="width: 0%">0%</div>
                </div>
            </div>

            <div id="word-finder-output" class="output empty"></div>
        </div>

        <!-- Keyboard Heatmap -->
        <div id="keyboard" class="tool-section">
            <h2 class="tool-title">Keyboard Heatmap</h2>
            <p class="tool-description">Shows letter frequency on different keyboard layouts</p>
            
            <div class="input-group">
                <label>Text</label>
                <textarea id="keyboard-input" placeholder="Enter text to analyze"></textarea>
            </div>

            <div class="input-group">
                <label>Keyboard Layout</label>
                <select id="keyboard-layout">
                    <option value="qwerty">QWERTY</option>
                    <option value="azerty">AZERTY</option>
                    <option value="qwertz">QWERTZ</option>
                    <option value="dvorak">Dvorak</option>
                </select>
            </div>

            <button class="btn btn-primary" onclick="runKeyboard()">Generate Heatmap</button>
            <button class="btn btn-secondary" onclick="clearOutput('keyboard-output')">Clear</button>

            <div id="keyboard-output" class="output empty"></div>
        </div>

        <!-- Punycode Decoder -->
        <div id="punycode" class="tool-section">
            <h2 class="tool-title">Punycode Decoder</h2>
            <p class="tool-description">Decode punycode (internationalized domain names)</p>
            
            <div class="instructions">
                Enter punycode without the "xn--" prefix<br>
                Example: <code>qi7caadfjbbc1cybacagatei0h</code>
            </div>

            <div class="input-group">
                <label>Punycode</label>
                <input type="text" id="punycode-input" placeholder="qi7caadfjbbc1cybacagatei0h">
            </div>

            <button class="btn btn-primary" onclick="runPunycode()">Decode</button>
            <button class="btn btn-secondary" onclick="clearOutput('punycode-output')">Clear</button>

            <div id="punycode-output" class="output empty"></div>
        </div>
    </div>

    <div class="footer">
        Cryptanalysis Toolkit
    </div>

    <script src="script.js"></script>
</body>
</html>
